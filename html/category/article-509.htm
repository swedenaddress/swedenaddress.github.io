<!doctype html>
<html lang="zh-CN">

<head>
    <!-- Required meta tags -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="canonical" href="https://swedenaddress.github.io/html/category/article-509.htm" />
<link rel="icon" href="/assets/addons/xcblog/img/swedenaddress/favicon.ico" type="image/x-icon"/>
<title>OpenPose环境搭建的经历 - SwedenAddress</title>
<link rel="stylesheet" href="/assets/addons/xcblog/css/swedenaddress/style-starter.css">
<link href="https://fonts.googleapis.com/css?family=Josefin+Slab:400,700,700i&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Poppins:400,700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap" rel="stylesheet">
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?ff0c66a832e6568df61664f01ded8b73";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3332997411212854"
     crossorigin="anonymous"></script>
</head>

<body id="home">
    <section class=" w3l-header-4 header-sticky">
    <header class="absolute-top">
        <div class="container">
            <nav class="navbar navbar-expand-lg navbar-light">
                                <a class="navbar-brand" href="/">
                        Sweden Address
                    </a>
                                <button class="navbar-toggler bg-gradient collapsed" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="fa icon-expand fa-bars"></span>
                    <span class="fa icon-close fa-times"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav mx-auto">
                                                <li class="nav-item">
                            <a class="nav-link" href="/">首页</a>
                        </li>
                                                <li class="nav-item">
                            <a class="nav-link" href="/html/category/">文章分类</a>
                        </li>
                                                <li class="nav-item">
                            <a class="nav-link" href="#">关于</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">联系</a>
                        </li>
                    </ul>
                </div>
        </div>
        </nav>
        </div>
    </header>
</section>
<script src="/assets/addons/xcblog/js/frontend/swedenaddress/jquery-3.3.1.min.js"></script> <!-- Common jquery plugin -->
<!--bootstrap working-->
<script src="/assets/addons/xcblog/js/frontend/swedenaddress/bootstrap.min.js"></script>
<!-- //bootstrap working-->
<!-- disable body scroll which navbar is in active -->
<script>
$(function() {
    $('.navbar-toggler').click(function() {
        $('body').toggleClass('noscroll');
    })
});
</script>
    <!-- breadcrumbs -->
    <section class="w3l-inner-banner-main">
        <div class="about-inner about ">
            <div class="container">
                <div class="main-titles-head text-center">
                    <h1 class="header-name" style="word-break: break-all;">
                        OpenPose环境搭建的经历                    </h1>
                    
                </div>
            </div>
        </div>
        <div class="breadcrumbs-sub">
            <div class="container">
                <ul class="breadcrumbs-custom-path">
                    <li class="right-side propClone"><a href="/" class="">首页 <span class="fa fa-angle-right" aria-hidden="true"></span></a>
                        <p>
                    </li>
                    <li class="right-side propClone"><a href="/html/category/" class="">文章分类 <span class="fa fa-angle-right" aria-hidden="true"></span></a>
                        <p>
                    </li>
                    <li class="active ">正文</li>
                </ul>
            </div>
        </div>
        </div>
    </section>
    <!-- breadcrumbs //-->
    <section class="w3l-content-with-photo-4" id="about">
        <div class="content-with-photo4-block ">
            <div class="container">
                <div class="row">
                    <div class="col-md-9">
                          				  				  				<div id="content_views" class="markdown_views prism-atom-one-dark"> <p>OpenPose环境搭建的经历</p> <p>由于毕设要用到OpenPose做人脸识别的项目，自己没有用过，也只能硬着头皮从零开始上了</p> <h2>电脑配置需求</h2> <p>  1.window 10 或者 Linux 系统都可以<br />   2.GPU 必须是英伟达的显卡，CUDA技术对显卡的是比较挑的，显卡的CUDA核心越多工作效率越高，核心频率、显存频率越高越好，显存容量不要低于２GB，然而经历过21年的矿潮后，还有什么显卡是值得你拥有的。 GTX960？？？对不起我不想做接盘侠，然而我还有的选吗？毕竟太穷了。<br />   集显？？？哎~~~所以我笔记本用不了只能台式机死马当活马医了，毕竟疫情封校快递都停了，么的选择。</p> <h2>文件下载和安装教程（直接转载试过的 经验贴，有问题的解决方案也带上）</h2> <p>用的VS2017<br /> CUDA10.0</p> <h2>1.win10 环境配置 链接:link.</h2> <p>  文件的下载和安装都挺全的，在运行bat下载models的过程中是真的慢几百兆的文件要下好几个小时，问题出现在了CMake 的配置问题集中在Visual Studio 上 链接:link.<br /> 自然还存在其他问题，只能根据CMake的报错查解决方案了。</p> <p><img decoding="async" src="http://img.555519.xyz/uploads/20221117/ffaf3d0ff1ef78199797f07030869015.jpg" alt="OpenPose环境搭建的经历"><br /> 已经试过的解决方案：<br /> 1.安装windows 8.1 SDK<br /> 2.path中添加MSBuild的路径，在cmd中调用MSBuild.exe能够显示出对应的版本号。<br /> 3.去掉openpose的文件名中的（.）<br /> 4.重装不同版本的CMake的。<br /> 至于其他的解决方案在内网外网查了好久也没有找到对症的解决方案，无用功做的太多了，自己就麻木了，最后去了CMake的官方论坛发表了自己的问题，死马当活马医吧。<br /> CMake的帖子link.</p> <p>  最后终于瞎猫碰上死耗子，解决了这个问题，奉上图片为证<br /><img decoding="async" src="http://img.555519.xyz/uploads/20221117/5d3a4a131eb8a47bb88a6139eb26c22b.jpg" alt="OpenPose环境搭建的经历"><br />   查到了CMU的Openpose的实验实官方的安装思路，和规避错误的步骤，软件安装步骤上链接link.<br />   1.主要讲了软件的安装步骤，首先 安装CMake-gui 版本要对应Windows win64-x64格式的，我试过好多版本，最终装的是3.18版的。CMake历史版本链接link.<br />    2.重点注意的是先安装完成Visual Studio 2015/2017/2019版本中的一个，配置完环境变量<br /><img decoding="async" src="http://img.555519.xyz/uploads/20221117/e6e28a946a332cf59e4f3c7a35573798.jpg" alt="OpenPose环境搭建的经历"><br /><img decoding="async" src="http://img.555519.xyz/uploads/20221117/1b325ff4905c3050c8591f5304b2b0bc.jpg" alt="OpenPose环境搭建的经历"><br /> 以防万一MSBuild的地址添加了两处</p> <p>  后再安装CUDA和cuDNN,其中CUDA会VS的版本进行不同的配置（之前重装过几遍VS），所以VS变了就要重装CUDA，cuDNN下载解压完成后要合并到CUDA的安装目录中，剩下的就是一些操作步骤中可能出现的问题解决方案了。<br />   还有一个官方的硬件方面的指导链接link.<br /> 3.将openpose转移到了C盘根目录下了。</p> <p>  不过奇怪的是我已经通过openpose中的.bat文件下载过需要的文件，CMake 点了Configuration之后还在重新下，这玩意等他下载完不知道猴年马月的，<br /><img decoding="async" src="http://img.555519.xyz/uploads/20221117/058ce5d7a009b2e716415a5f01597fcf.jpg" alt="OpenPose环境搭建的经历"><br />   靠CMake下载完这些models基本没戏，还是自己去找官网地址下载吧</p> <ol> <li>\openpose\models\pose\body_25\pose_iter_584000.caffemodel：http://posefs1.perception.cs.cmu.edu/OpenPose/models/pose/body_25/pose_iter_584000.caffemodel</li> <li>\openpose\models\pose\coco\pose_iter_440000.caffemodel:<br /> http://posefs1.perception.cs.cmu.edu/OpenPose/models/pose/coco/pose_iter_440000.caffemodel</li> <li>\openpose\models\pose\mpi\pose_iter_160000.caffemodel:http:<br /> http://posefs1.perception.cs.cmu.edu/OpenPose/models/pose/mpi/pose_iter_160000.caffemodel</li> <li>\openpose\models\face\pose_iter_116000.caffemodel:<br /> http://posefs1.perception.cs.cmu.edu/OpenPose/models/face/pose_iter_116000.caffemodel</li> <li>openpose\models\hand\pose_iter_102000.caffemodel:<br /> http://posefs1.perception.cs.cmu.edu/OpenPose/models/hand/pose_iter_102000.caffemodel</li> </ol> <p>还有第三方库的其他组件,才几百兆的文件，.bat下载速度才几KB/s 太慢，复制网址下载完后再拷贝到对应目录中</p> <ol> <li>3rdparty\caffe<br /> https://gitee.com/Somnambulist-liu/caffe</li> <li>3rdparty\pybind11:<br /> https://codeload.github.com/pybind/pybind11/zip/refs/heads/master</li> <li>3rdparty/windows/caffe:<br /> http://posefs1.perception.cs.cmu.edu/OpenPose/3rdparty/windows/caffe_16_2020_11_14.zip</li> <li>3rdparty/windows/opencv：<br /> http://posefs1.perception.cs.cmu.edu/OpenPose/3rdparty/windows/opencv_450_v15_2020_11_18.zip<br /> 在CMakeConfiguration的时候，如果出现提示在下载任意的第三方组件或者models的时候，按停止键，直接复制显示出来的下载地址去网页中直接下载好在拷贝然后解压到对应目录，重新CMake,明明之前解压过一遍，但是CMake说不行那就再解压一遍。<br /> 最后通过了<br /><img decoding="async" src="http://img.555519.xyz/uploads/20221117/bf08976559578ed91173334957ace1b9.jpg" alt="OpenPose环境搭建的经历"><br /> open project然后对ALL_BUILD生成exe成功。<br /><img decoding="async" src="http://img.555519.xyz/uploads/20221117/46376c33ea5b3c5a852251a40e59b2aa.jpg" alt="OpenPose环境搭建的经历"><br /> 然后C++API中设置启动项<br /><img decoding="async" src="http://img.555519.xyz/uploads/20221117/0e49b84d8506bfa3346ca36b749e718d.jpg" alt="OpenPose环境搭建的经历"><br /> 调成release x64模式运行，然后出现了如下错误，好像是显存不够了<br /><img decoding="async" src="http://img.555519.xyz/uploads/20221117/8add050affaf44dc2ce6f5c212dcb33a.jpg" alt="OpenPose环境搭建的经历"><br /> 又没有其他更好的显卡，看样子需要修改参数才能运行<br /> 官方有加快处理速度的教程</li> </ol> <p>巧合下我换了openpose1.5,试了一下，小一些的图片还是能够运行识别的，文件太大的话还是会出现out of memery,官方说在windows中使用粗DNN加持后只识别人体关节点至少需要2.2G to Body_25 1.5G to COCO,如果再加上面部或手部的话4G都不够。真的明白了为什么一些专业显卡动不动就需要24G的显存。<br /> Body_25是GPU版本下最快、最准确，当然前提是你的显存足够大，COCO适用于CPU版本说是会被移除。<br /> 之后便是一顿测试识别图片没问题</p> <p>切换模型和加速说是要在OpenPoseDemo中main函数指定位置里添加</p> <pre><code class="prism language-cpp">	FLAGS_model_pose<span class="token operator">=</span><span class="token string">"COCO"</span><span class="token punctuation">;</span> 	FLAGS_net_resolution<span class="token operator">=</span><span class="token string">"320x176"</span><span class="token punctuation">;</span></code></pre> <p>还没试过，估计不明就里还是没效果，<br /><img decoding="async" src="http://img.555519.xyz/uploads/20221117/561c68c0535ac11fde7b0540ffa0e6ab.jpg" alt="OpenPose环境搭建的经历"></p> <p>  识别视频并转换输出需要找一下教程我用的是显卡识别的，搜索的时候油管的几个视频使用的设CPU版本的用不到VS直接使用bin\OpenPoseDemo.exe在DOS里命令行处理，我也试了一下官方说需要把DLL文件拷贝到指定位置才能像CPU版本的一样使用命令行操作。[OpenposeDemo.exe].结果指定位置的链接炸了OpenPoseDemo.exe --video examples\media\video.avi --write_json output_json_folder --face --write_video examples\media\video.avi<br />   看官方的说法，如果你在windows上使用的VS，基本上是用来修改编译源代码或者链接第三方库什么的，反正意思就是想要用的顺就得磕源码，如果说你用的是portable便携版的，只需要DOS中输命令使用OpenPoseDemo.exe就行，相关的命令官方文档里有讲比较简单，可是怎么通过VS操作Openpose，官方文档里很少讲而且仅有的几条说明链接还炸了。心累.jpg。。。</p> <p>更改识别项目我从其他安装视频中学到一招贴图如下<br /><img decoding="async" src="http://img.555519.xyz/uploads/20221117/ea29ca16b09552ced678ef8290529f5c.jpg" alt="OpenPose环境搭建的经历"></p> <p>关于如何使用Python使用Openpose这个问题，https://www.youtube.com/watch?v=l4wYt0Ghos0，这个视频里有详细的方法，其实使用Openpose是C++源码编译的，Python语言的使用本质上是调用项目的API接口。</p> </p> <h2>2linux 环境配置</h2> <p>先用虚拟机试一下吧，等快递解封了再买块固态装一下试试。<br /> Ubuntu20.4LTS<br /> CUDA11.1</p> <p>主要参考的是CSDN上的schoolblack的两篇文章操作，安装CUDA和cuDNN[link1].<br /> openpose的配置[link2]<br /> 还有一个全教程[link全教程].三个参考教程参考着弄，肯定还会出错（心累）<br /> 对了还有一个逼乎的链接最终效果要跟他的一样[link逼乎].</p> <p>嗯。。。出错了下载完CUDA解压时tmp临时存储空间不够清空了一下回收站，然后再试gcc 版本不对,看逼乎上说的估计时Ubuntu的一些组件需要更新一遍，做好准备工作才行，可是下载速度真的好慢呀。<br /><img decoding="async" src="http://img.555519.xyz/uploads/20221117/c638ec3dcbbae48da60d044da6bce910.jpg" alt="OpenPose环境搭建的经历"></p> <h2>试了试pytorch-openpose版本（简易版），Pycharm虚拟环境配置</h2> <p>参考视频B站linkB站.<br /> 安装组件的时候要关闭代理软件，否则会下载链接失败，Pip的安装地址替换成国内的镜像网站下载能够快很多，常见的镜像网站就这几个：<br />   清华大学 https://pypi.tuna.tsinghua.edu.cn/simple<br />   中国科技大学 https://pypi.mirrors.ustc.edu.cn/simple<br />   豆瓣(douban) https://pypi.douban.com/simple<br />   阿里云 https://mirrors.aliyun.com/pypi/simple<br /><img decoding="async" src="http://img.555519.xyz/uploads/20221117/d423ad17bf823cdf151a6865ef8c631d.jpg" alt="OpenPose环境搭建的经历"></p> <p>  第一次运行时出现了一个错误：ImportError: cannot import name ‘PILLOW_VERSION’ from ‘PIL’<br /> 打开cmd,<br /> 卸载当前的版本，安装7.0以前的版本pillow</p> <pre><code>pip uninstall pillow Yes pip install Pillow==6.2.2 --user</code></pre> <p>卸载重装pillow[link].<br /> 之后修改最后一行的报错.py文件中的PILLOW_VERSION为__version__<br /> 再次运行一下可以识别测试视频了<br />   嗯，这个方法出的幺蛾子最少，而且十分的简单吗，对小白很友好，可是我做的项目这个简易版本功能太少了，处理速度也不行，只能说寄了，白费功夫，还是转到windows 和Ubuntu上试试吧。</p> </div> 			
                        <div class="col-md-12 mt-5">
                                                        <p>上一个：<a href="/html/category/article-508.htm">Libco Hook 机制浅析_在线工具</a></p>
                                                        <p>下一个：<a href="/html/category/article-510.htm">PHP对象序列化</a></p>
                                                    </div>

                                            </div>
                    <div class="col-md-3">
                        <div class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">热门文章</h3>
    </div>
    <div class="panel-body">
        <ul class="p-0 x-0" style="list-style: none;margin: 0;padding: 0;">
                        <li class="py-2"><a href="/html/category/article-4371.htm" title="瑞鹏宠物医院百度百科（瑞鹏宠物医院成立时间）">瑞鹏宠物医院百度百科（瑞鹏宠物医院成立时间）</a></li>
                        <li class="py-2"><a href="/html/category/article-2242.htm" title="Spring中的Ant路径匹配工具组件AntPathMatcher">Spring中的Ant路径匹配工具组件AntPathMatcher</a></li>
                        <li class="py-2"><a href="/html/category/article-4070.htm" title="taro跳转到tabBar报错问题">taro跳转到tabBar报错问题</a></li>
                        <li class="py-2"><a href="/html/category/article-4404.htm" title="动物疫苗品牌排名前十 动物疫苗品牌排名前十名">动物疫苗品牌排名前十 动物疫苗品牌排名前十名</a></li>
                        <li class="py-2"><a href="/html/category/article-2825.htm" title="MySQL VARCHAR列的最大长度是多少？">MySQL VARCHAR列的最大长度是多少？</a></li>
                        <li class="py-2"><a href="/html/category/article-4517.htm" title="味蕾工坊（味蕾工坊蛋糕）">味蕾工坊（味蕾工坊蛋糕）</a></li>
                        <li class="py-2"><a href="/html/category/article-4324.htm" title="动物疫苗证明怎么写（动物疫苗证明怎么写的）">动物疫苗证明怎么写（动物疫苗证明怎么写的）</a></li>
                        <li class="py-2"><a href="/html/category/article-1333.htm" title="在vue项目中如何获取视频的时长_vue.js_">在vue项目中如何获取视频的时长_vue.js_</a></li>
                        <li class="py-2"><a href="/html/category/article-3731.htm" title="夯实基础图解作用域链和闭包">夯实基础图解作用域链和闭包</a></li>
                        <li class="py-2"><a href="/html/category/article-1914.htm" title="VSCode插件离线安装">VSCode插件离线安装</a></li>
                    </ul>
    </div>
</div>

<div class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">归纳</h3>
    </div>
    <div class="panel-body">
        <ul class="p-0 x-0" style="list-style: none;margin: 0;padding: 0;">
                        <li class="py-2">
                <h4><span class="badge" style="float: right;">30</span> <a href="/html/date/2024-07/" title="2024-07 归档">2024-07</a></h4>
            </li>
                        <li class="py-2">
                <h4><span class="badge" style="float: right;">60</span> <a href="/html/date/2024-06/" title="2024-06 归档">2024-06</a></h4>
            </li>
                        <li class="py-2">
                <h4><span class="badge" style="float: right;">62</span> <a href="/html/date/2024-05/" title="2024-05 归档">2024-05</a></h4>
            </li>
                        <li class="py-2">
                <h4><span class="badge" style="float: right;">60</span> <a href="/html/date/2024-04/" title="2024-04 归档">2024-04</a></h4>
            </li>
                        <li class="py-2">
                <h4><span class="badge" style="float: right;">62</span> <a href="/html/date/2024-03/" title="2024-03 归档">2024-03</a></h4>
            </li>
                        <li class="py-2">
                <h4><span class="badge" style="float: right;">58</span> <a href="/html/date/2024-02/" title="2024-02 归档">2024-02</a></h4>
            </li>
                    </ul>
    </div>
</div>



                    </div>
                </div>
            
            </div>
        </div>
    </section>
    
        <section class="w3l-footer-29-main w3l-copyright">
        <div class="container">
            <div class="row bottom-copies">
                <p class="col-lg-8 copy-footer-29">
                    SwedenAddress 版权所有
                    <br />
                    Powered by WordPress
                </p>
                <div class="col-lg-4 main-social-footer-29">
                    <a href="#facebook" class="facebook"><span class="fa fa-facebook"></span></a>
                    <a href="#twitter" class="twitter"><span class="fa fa-twitter"></span></a>
                    <a href="#instagram" class="instagram"><span class="fa fa-instagram"></span></a>
                    <a href="#linkedin" class="linkedin"><span class="fa fa-linkedin"></span></a>
                </div>
            </div>
        </div>
    </section>
    <!-- move top -->
    <button onclick="topFunction()" id="movetop" title="Go to top">
        <span class="fa fa-long-arrow-up"></span>
    </button>
    <script>
    // When the user scrolls down 20px from the top of the document, show the button
    window.onscroll = function() {
        scrollFunction()
    };

    function scrollFunction() {
        if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
            document.getElementById("movetop").style.display = "block";
        } else {
            document.getElementById("movetop").style.display = "none";
        }
    }

    // When the user clicks on the button, scroll to the top of the document
    function topFunction() {
        document.body.scrollTop = 0;
        document.documentElement.scrollTop = 0;
    }
    </script>
    <!-- /move top -->
    <script>
    $(function() {
        $('.js_to').click(function(){
            var url = $(this).data('url');
            var code = $(this).data('code');
            url += code;

            window.open(url);
        })
    });
    </script>
</body>

</html>